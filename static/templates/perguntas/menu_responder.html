{% extends 'base.html' %}
{% load app_filters %}

{% block responder_active %}active{% endblock %}


{% block jumbotrone %}

<!-- Modal -->
<div class="modal " id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Alterar tópicos de conhecimento:</h4>
      </div>
      <div class="modal-body">
        <div class="container-fluid">
            <p><b>Já Adicionados:</b></p>
            <div class="row">
                {% for tpc in topics %}
                <div class="col-sm-4">
                <button class="add_topic_know btn btn-sm btn-warning" data-topicid='{{ tpc.pk }}'>{{ tpc.nome|title }} <i class="fa fa-times"></i></button>
                </div>
                {% endfor %}
            </div>
            <hr>
            <p><b>Adicionar Novos:</b></p>
            <div class="row">
                {% for tpc in topics_sugestion %}
                <div class="col-sm-4">
                <button class="add_topic_know btn btn-sm btn-default" data-topicid='{{ tpc.pk }}'>{{ tpc.nome|title }} <i class="fa fa-plus"></i></button>
                </div>
                {% endfor %}
            </div>  
        </div><!-- container-fluid -->
      </div>
      <div class="modal-footer">
        <a href="{% url 'responder-perguntas' %}" class="btn btn-default">Atualizar</a>
        
      </div>
    </div>
  </div>
</div>

{% endblock %}


{% block content %}

<p class="lead blog-description">Perguntas que talvez você possa responder:</p>

{% for pergunta in sugestions %}
    
    <div class="blog-post">
        <p class="info-text">{% for tag in pergunta.tags.all %}<a href="{% url 'categoria' tag.slug %}"><span class="label label-tag">{{ tag.nome|title }}</span></a> {% endfor %}<span class="bullet"> • </span>{{ pergunta.data|post_date }}</p>
        <h2 class="blog-post-title"><a href="{% url 'pergunta' pergunta.slug %}">{{ pergunta.titulo }}</a></h2>        
        {% if pergunta.descricao %}<p class='text'>{{ pergunta.descricao|striptags|truncatewords:30 }} <a href="{% url 'pergunta' pergunta.slug %}">mais ...</a></p>{% endif %}
        <p class="info-text">
        <a href="{% url 'responder' pergunta.id %}" class="btn btn-default">Responder</a>
        <span class="bullet"> • </span>
        {{ pergunta.follow_questions.all|length }} seguindo
        <span class="bullet"> • </span>
        vista: {{ pergunta.views }} vezes
        </p>
            
    </div><!-- /.blog-post -->
    <hr>
{% endfor %}



<div class="pagination">
    <span class="step-links">
        {% if sugestions.has_previous %}
            <a href="?page={{ sugestions.previous_page_number }}"  class="btn btn-default"><i class="fa fa-arrow-left"></i> anterior</a>
        {% endif %}

        <span class="info-text">
            página {{ sugestions.number }} de {{ sugestions.paginator.num_pages }} 
        </span>

        {% if sugestions.has_next %}
            <a href="?page={{ sugestions.next_page_number }}" class="btn btn-default">próxima <i class="fa fa-arrow-right"></i></a>
        {% endif %}
    </span>
</div>

{% endblock %}


{% block sidebar %}
    <div class="sidebar-module sidebar-module-inset">
        <div class="well">
        <h4>Temas que você conhece bem:</h4>
        <p>
        {% for tag in topics %}
        <a href="{% url 'categoria' tag.slug %}"><span class="label label-tag">{{ tag|title }}</span></a>
        {% endfor %}
        </p>
    <button class="btn btn-default"  data-toggle="modal" data-target="#myModal" title="Alterar tópicos de conhecimento.">Alterar Temas</button>
    </div>
    <hr>
    <br>        
        
        
        <h4>Atividades Recentes</h4>
        {% for ativ in atividades_recentes %}
            {% if ativ.classe = 'pergunta' %}
                <p><a href='{% url 'profile' ativ.autor.userprofile.slug %}'>{{ ativ.autor.userprofile.name }}</a> perguntou:</p>
                <p><a href="{% url 'pergunta' ativ.slug %}">{{ ativ.titulo }}</a></p>
                <p><i> - {{ ativ.timestamp }}</i></p>
                <hr>
            {% elif ativ.classe = 'resposta' %}
                <p><a href="{% url 'profile' ativ.autor.userprofile.slug %}">{{ ativ.autor.userprofile.name }}</a> respondeu:</p>
                <p><a href="{% url 'pergunta' ativ.pergunta.slug %}">{{ ativ.resposta|safe|truncatewords_html:30 }}</a></p>
                <p><i> - {{ ativ.timestamp }}</i></p>
                <hr>
            {% endif %}
        {% endfor %}
    </div>
    <div class="sidebar-module">
        <h4>Tópicos am Alta</h4>
        {% for tg in tags_todas %}
            <p class="sidebar-tags"><a href="{% url 'categoria' tg.slug %}"><span class="label label-tag">{{ tg.nome }}</span></a></p>
        {% endfor %}
    </div>
    <div class="sidebar-module">
      <h4>Membros Mais Ativos</h4>
      <ol class="list-unstyled">
        <li><a href="#">GitHub</a></li>
        <li><a href="#">Twitter</a></li>
        <li><a href="#">Facebook</a></li>
      </ol>
    </div>
{% endblock %}